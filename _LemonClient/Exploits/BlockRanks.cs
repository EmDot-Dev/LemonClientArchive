using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using UnityEngine;
using MelonLoader;
using VRC;
using VRC.DataModel;
using VRC.UI;
using System.Collections;

namespace _LemonClient.Exploits
{
    class BlockRanks
    {
        public static IEnumerator BlockRankCall(string rankName)
        {
            List<VRC.Player>.Enumerator enumeratorList = ExtraDependencies.PlayerWrapper.AllPlayers.GetEnumerator();
            while (enumeratorList.MoveNext())
            {
                Player currentPlayer = enumeratorList.Current;
                PageUserInfo currentTargetMenu = GameObject.Find("Screens").transform.Find("UserInfo").GetComponent<PageUserInfo>();
                currentTargetMenu.field_Private_APIUser_0 = currentPlayer.field_Private_APIUser_0;

                if (rankName == "Visitor")
                {
                    if (!currentPlayer.field_Private_APIUser_0.hasBasicTrustLevel)                                                   //No basic level trust means visitor
                    {
                        currentTargetMenu.ToggleBlock();
                    }
                }
                else if (rankName == "NewUser")
                {
                    if (currentPlayer.field_Private_APIUser_0.hasBasicTrustLevel)                                                    //Has basic level trust meaning New User or above
                    {
                        if (!currentPlayer.field_Private_APIUser_0.hasKnownTrustLevel)                                               //No known level trust meaning Only New User
                        {
                            currentTargetMenu.ToggleBlock();
                        }
                    }
                }
                else if (rankName == "User")
                {
                    if (currentPlayer.field_Private_APIUser_0.hasKnownTrustLevel)                                                    //Has known level trust meaning User or above
                    {
                        if (!currentPlayer.field_Private_APIUser_0.hasTrustedTrustLevel)                                             //No trusted level trust meaning User
                        {
                            currentTargetMenu.ToggleBlock();
                        }
                    }
                }
                else if (rankName == "KnownUser")
                {
                    if (currentPlayer.field_Private_APIUser_0.hasTrustedTrustLevel)                                                  //Has Trusted level trust meaning Known User or above
                    {
                        if (!currentPlayer.field_Private_APIUser_0.hasVeteranTrustLevel)                                             //No veteran level trust meaning known user
                        {
                            currentTargetMenu.ToggleBlock();
                        }
                    }
                }
                else if (rankName == "TrustedUser")
                {
                    if (currentPlayer.field_Private_APIUser_0.hasVeteranTrustLevel)                                                  //Has veteran 
                    {
                        currentTargetMenu.ToggleBlock();
                    }
                }
                else if (rankName == "ALL")                                                                                         //All players
                {
                    currentTargetMenu.ToggleBlock();
                }
                else
                {
                    return null;
                }
            }
            return null;
        }
    }
}
